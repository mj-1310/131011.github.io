---
layout: post
title: "머신러닝 13. 지도학습: 분류모델-의사결정나무"
author: "MJ"
categories: [science, statistical_method]
tags: [statistics, machinelearning, multicampus, bigdata_analysis_edu, GNT]
image: 
---

---
&nbsp; &nbsp; **목차**<br>
&nbsp; &nbsp; 1. [데이터셋 로딩](#1)<br>
&nbsp; &nbsp;&nbsp;&nbsp; (1) [데이터셋 로딩](#1_1)<br>
&nbsp; &nbsp;&nbsp;&nbsp; (2) [데이터셋 간단조회: head() / str() / summary()](#1_2)<br>
&nbsp; &nbsp; 2. [데이터탐색](#2)<br>
&nbsp; &nbsp;&nbsp;&nbsp; (1) [사전분류규칙 존재가능성 탐색: boxplot() / plot() / legend() / pairs()](#2_1)<br>
&nbsp; &nbsp;&nbsp;&nbsp; (2) [투입변수간 관련성 분석: caret::featurePlot() / car::scatterplotMatrix()](#2_2)<br>
&nbsp; &nbsp;&nbsp;&nbsp; (3) [분류규칙에 가장 영향을 많이 미치는 변수는 무엇인지를 탐색: FSelector::chi.squared() / cutoff.k()](#2_3)<br>
&nbsp; &nbsp; 3. [데이터 전처리](#3)<br>
&nbsp; &nbsp;&nbsp;&nbsp; (1) [범주형 변수의 팩터변수화: factor()](#3_1)<br>
&nbsp; &nbsp;&nbsp;&nbsp; (2) [분류분석용 데이터 추출(train, test): sample() / addmargins()](#3_2)<br>
&nbsp; &nbsp; 4. [의사결정나무1: party::ctree()](#4)<br>
&nbsp; &nbsp;&nbsp;&nbsp; (1) [훈련 데이터로 분류규칙 생성: ~ / paty::ctree()](#4_1)<br>
&nbsp; &nbsp;&nbsp;&nbsp; (2) [분류규칙 그래프 확인: plot()](#4_2)<br>
&nbsp; &nbsp;&nbsp;&nbsp; (3) [분류규칙 이용한 학습 데이터 분류분석: predict()](#4_3)<br>
&nbsp; &nbsp;&nbsp;&nbsp; (4) [학습 데이터 분류결과 정확성(Accuracy) 평가: sum() / diag() / sum(sum/diag)](#4_4)<br>
&nbsp; &nbsp;&nbsp;&nbsp; (5) [분류규칙 이용한 검증 데이터 분류분석: predict()](#4_5)<br>
&nbsp; &nbsp;&nbsp;&nbsp; (6) [검증 데이터 분류결과 정확성(Accuracy) 평가: sum() / diag() / sum(sum/diag)](#4_6)<br>
&nbsp; &nbsp;&nbsp;&nbsp; (7) [학습 데이터와 검증 데이터의 정확성 비교](#4_7)<br>
&nbsp; &nbsp;&nbsp;&nbsp; (8) [예측모델 성능평가](#4_8)<br>
&nbsp; &nbsp; 5. [혼동표](#5)<br>
&nbsp; &nbsp;&nbsp;&nbsp; (1) [혼동표: caret::confusionMatrix()](#5_1)<br>
&nbsp; &nbsp;&nbsp;&nbsp; (2) [도출된 규칙을 활용한 고객 추출: subset()](#5_2)<br>
&nbsp; &nbsp;&nbsp;&nbsp; (3) [결과 프로파일링: psych::describe()](#5_3)<br>
&nbsp; &nbsp; 6. [의사결정나무2: tree::tree()](#6)<br>
&nbsp; &nbsp;&nbsp;&nbsp; (1) [훈련 데이터로 분류규칙 생성](#6_1)<br>
&nbsp; &nbsp;&nbsp;&nbsp; (2) [의사결정나무의 프루닝 가능성 분석: cv.tree() / prune.misclass()](#6_2)<br>
&nbsp; &nbsp;&nbsp;&nbsp; (3) [분류규칙 이용학 학습/검증 데이터 분류분석 및 혼동표](#6_3)<br>
&nbsp; &nbsp; 7. [의사결정나무3: rpart::rpart()](#7)<br>
&nbsp; &nbsp;&nbsp;&nbsp; (1) [분류분석 모델 관계식 정의](#7_1)<br>
&nbsp; &nbsp;&nbsp;&nbsp; (2) [의사결정나무의 가지치기(Prunning) 가능성 분석: printcp() / plotcp() / prune() / which.min()](#7_2)<br>
&nbsp; &nbsp;&nbsp;&nbsp; (3) [가지치기 이후 정제된 의사결정나무: plot() / text()](#7_3)<br>
&nbsp; &nbsp;&nbsp;&nbsp; (4) [분류규칙 이용한 학습 데이터 분류분석 및 정확성 평가](#7_4)<br>
&nbsp; &nbsp;&nbsp;&nbsp; (5) [분류규칙 이용한 훈련 데이터 분류분석 및 정확성 평가](#7_5)<br>
&nbsp; &nbsp;&nbsp;&nbsp; (6) [학습 데이터와 검증 데이터의 정확성 비교](#7_6)<br>
&nbsp; &nbsp;&nbsp;&nbsp; (7) [혼동표](#4_7)<br>

---


<br>


<br>

---------------코딩------------------------------------------------------------------------------------------------------

<br>


##### 6. 비즈니스 시나리오

- 카드사 이용고객 중 쿠폰이벤트를 진행했을 때 반응을 보이는 고객과 그렇지 않은 고객으로 나뉘고 있음

- 어떤 특성을 가진 고객이 쿠폰이벤트에 반응을 보이는지?

- 어떤 특성을 가진 고객이 쿠폰이벤트에 반응을 보이지 않는지?

- 반응 유무를 결정하는 조건/요인/속성/변수/기준/피처(feature)와 이들이 가지는 임계치와 상대적인 중요도는?


#####. 분석 모델링 및 조작적 정의

- usage(월평균 카드사용횟수) --> 수치데이터(횟수)

- amount(1회평균 카드사용금액) --> 수치데이터(만원)

- period(1회평균 온라인쇼핑몰 접속시간) --> 수치데이터(분)

- variety(상품구매다양성) --> 수치데이터(부문)

- response(쿠폰반응유형) --> 0:nr(반응안함, no-response)

                         --> 1:low(단순/저가구매)

                         --> 2:high(복합/고가구매)



<br>

<!-- ------------------------------------------------------------------------------------------------------------------------------- -->

<a id="1"></a>

## 1. 데이터셋 로딩

<br>

<a id="1_1"></a>

### (1) 데이터셋 로딩

<br>

<br>

<!-- ------------------------------------------------------------------------------------------------------------------------------- -->

<a id="1_2"></a>

### (2) 데이터셋 간단조회: head() / str() / summary()

<br>

<br><br>

<!-- ------------------------------------------------------------------------------------------------------------------------------- -->

<a id="2"></a>

## 2. 데이터탐색

<br>

<a id="2_1"></a>

### (1) 사전분류규칙 존재가능성 탐색: boxplot() / plot() / legend() / pairs()

<br>

<br>

<!-- ------------------------------------------------------------------------------------------------------------------------------- -->

<a id="2_2"></a>

### (2) 투입변수간 관련성 분석: caret::featurePlot() / car::scatterplotMatrix()

<br>

<br>

<!-- ------------------------------------------------------------------------------------------------------------------------------- -->

<a id="2_3"></a>

### (3) 분류규칙에 가장 영향을 많이 미치는 변수는 무엇인지를 탐색: FSelector::chi.squared() / cutoff.k()

<br>

<br><br>

<!-- ------------------------------------------------------------------------------------------------------------------------------- -->

<a id="3"></a>

## 3. 데이터 전처리

<br>

<a id="3_1"></a>

### (1) 범주형 변수의 팩터변수화: factor()

<br>

<br>

<!-- ------------------------------------------------------------------------------------------------------------------------------- -->

<a id="3_2"></a>

### (2) 분류분석용 데이터 추출(train, test): sample() / addmargins()

<br>

<br><br>

<!-- ------------------------------------------------------------------------------------------------------------------------------- -->

<a id="4"></a>

## 4. 의사결정나무1: party::ctree()

<br>

<a id="4_1"></a>

### (1) 훈련 데이터로 분류규칙 생성: ~ / paty::ctree()

<br>

<br>

<!-- ------------------------------------------------------------------------------------------------------------------------------- -->

<a id="4_2"></a>

### (2) 분류규칙 그래프 확인: plot()

<br>

<br>

<!-- ------------------------------------------------------------------------------------------------------------------------------- -->

<a id="4_3"></a>

### (3) 분류규칙 이용한 학습 데이터 분류분석: predict()

<br>

<br>

<!-- ------------------------------------------------------------------------------------------------------------------------------- -->

<a id="4_4"></a>

### (4) 학습 데이터 분류결과 정확성(Accuracy) 평가: sum() / diag() / sum(sum/diag)

<br>

<br>

<!-- ------------------------------------------------------------------------------------------------------------------------------- -->

<a id="4_5"></a>

### (5) 분류규칙 이용한 검증 데이터 분류분석: predict()

<br>

<br>

<!-- ------------------------------------------------------------------------------------------------------------------------------- -->

<a id="4_6"></a>

### (6) 검증 데이터 분류결과 정확성(Accuracy) 평가: sum() / diag() / sum(sum/diag)

<br>

<br>

<!-- ------------------------------------------------------------------------------------------------------------------------------- -->

<a id="4_7"></a>

### (7) 학습 데이터와 검증 데이터의 정확성 비교

<br>

<br>

<!-- ------------------------------------------------------------------------------------------------------------------------------- -->

<a id="4_8"></a>

### (8) 예측모델 성능평가

<br>

<br><b>

<!-- ------------------------------------------------------------------------------------------------------------------------------- -->

<a id="5"></a>

## 5. 혼동표

<br>

<a id="5_1"></a>

### (1) 혼동표: caret::confusionMatrix()

<br>

<br>

<!-- ------------------------------------------------------------------------------------------------------------------------------- -->

<a id="5_2"></a>

### (2) 도출된 규칙을 활용한 고객 추출: subset()

<br>

<br>

<!-- ------------------------------------------------------------------------------------------------------------------------------- -->

<a id="5_3"></a>

### (3) 결과 프로파일링: psych::describe()

<br>

<br><br>

<!-- ------------------------------------------------------------------------------------------------------------------------------- -->

<a id="6"></a>

## 6. 의사결정나무2: tree::tree()

<br>

<a id="6_1"></a>

### (1) 훈련 데이터로 분류규칙 생성

<br>

<br>

<!-- ------------------------------------------------------------------------------------------------------------------------------- -->

<a id="6_2"></a>

### (2) 의사결정나무의 프루닝 가능성 분석: cv.tree() / prune.misclass()

<br>

<br>

<!-- ------------------------------------------------------------------------------------------------------------------------------- -->

<a id="6_3"></a>

### (3) 분류규칙 이용학 학습/검증 데이터 분류분석 및 혼동표

<br>

<br><br>

<!-- ------------------------------------------------------------------------------------------------------------------------------- -->

<a id="7"></a>

## 7. 의사결정나무3: rpart::rpart()

<br>

<a id="7_1"></a>

### (1) 분류분석 모델 관계식 정의

<br>

<br>

<!-- ------------------------------------------------------------------------------------------------------------------------------- -->

<a id="7_2"></a>

### (2) 의사결정나무의 가지치기(Prunning) 가능성 분석: printcp() / plotcp() / prune() / which.min()

<br>

<br>

<!-- ------------------------------------------------------------------------------------------------------------------------------- -->

<a id="7_3"></a>

### (3) 가지치기 이후 정제된 의사결정나무: plot() / text()

<br>

<br>

<!-- ------------------------------------------------------------------------------------------------------------------------------- -->

<a id="7_4"></a>

### (4) 분류규칙 이용한 학습 데이터 분류분석 및 정확성 평가

<br>

<br>

<!-- ------------------------------------------------------------------------------------------------------------------------------- -->

<a id="7_5"></a>

### (5) 분류규칙 이용한 훈련 데이터 분류분석 및 정확성 평가

<br>

<br>

<!-- ------------------------------------------------------------------------------------------------------------------------------- -->

<a id="7_6"></a>

### (6) 학습 데이터와 검증 데이터의 정확성 비교

<br>

<br>

<!-- ------------------------------------------------------------------------------------------------------------------------------- -->

<a id="7_7"></a>

### (7) 혼동표


<br><br>
<!-- ------------------------------------------------------------------------------------------------------------------------------- -->

###### <참고 문헌> 

<br>

1. 최점기 박사님 강의 <br>